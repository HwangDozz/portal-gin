# portal-gin
portal项目代码仓库

## 参考项目链接

[eddycjy/go-gin-example: An example of gin (github.com)](https://github.com/eddycjy/go-gin-example)



## 目录结构

```
conf: 		配置文件放置目录
docs: 		存放sql建表文件、接口文档等团队功能性文档
middleware: 用户自己配置的中间件目录
models: 	模型文件存储目录
pkg:		功能性、辅助性项目文件目录
routers:	项目路由文件、请求处理函数文件目录
service:	请求处理函数 完整逻辑的处理文件目录
go.mod:		项目依赖文件
main.go:	项目启动入口文件
```



## 项目运行逻辑

<img src="C:\Users\Hwang\Desktop\大三下\images\gin框架项目架构\gin框架流程.drawio-1690388768488.png" alt="gin框架流程.drawio" style="zoom:80%;" />



## 重要目录说明

### 1. main.go文件

​	gin框架启动时从main.go文件的main函数进入，框架首先执行各个文件的Setup函数，初始化基本信息，main函数首先调用路由初始化函数，其次调用各个配置结构体完成服务实例（server）的信息配置，最终启动http服务，gin框架启动。

### 2. config目录

​	该目录下存放了**项目整体的配置文件 app.ini**，该文件以yaml格式存放了数据库连接、服务器运行地址等配置信息。

### 3. models目录

​	该目录下存放了**基础模型文件**和**专属模型文件**，所有专属模型文件结构体中包含了基础模型文件（类似于继承关系，继承了基础模型所有的字段和函数）。

**基础模型文件：**

​	定义了基础模型（包含了ID、增改删的时间字段），在SetUp初始化函数中**对数据库实例进行了初始化**，并定义了数据库更新的回调操作。

**专属模型文件：**

​	定义了某一业务的**具体模型**，如登录验证业务的User类模型，增加了该业务的专有字段，并借助gorm包（go语言ORM框架）定义了该业务中**对数据模型的增删改查函数**（类似于Spring Boot项目中的mapper层），便于service中的业务处理函数进行调用。

### 4. pkg目录

​	该目录下包含了用户封装的各种**业务模块的函数**，如：项目配置模块（setting）、请求处理模块（app）、文件图片处理（files、upload）、redis相关调用（gredis）、日志模块（logging）等。

**setting：**

​	该模块中的初始化函数从 **app.ini中读取了配置信息**，并将配置信息**保存到了各个配置信息结构体**中，最终在各个初始化函数中配置信息结构体被访问。

**app：**

​	该模块封装了关于请求的一些函数，如表单数据与模型实例的数据绑定、response的包装、请求错误处理的日志输出等函数。

**gredis：**

​	该模块封装了redis连接池初始化，以及一些常用的redis键值对的get、set、exist、delete等函数。

**file：**

​	该模块封装了一些文件相关操作，如文件大小的获取、文件权限的获取、文件是否存在、文件打开、新建目录等操作

**upload：**

​	该模块封装了图片上传时的存储路径、图片url、图片大小等信息的获取函数。

### 5. routers目录

​	该目录下包含了**路由引擎的初始化**、**路由表和路由组的配置**、各个**路由的中间件配置**等功能。

**routers.go：**

​	该文件提供的InitRouter函数对路由引擎进行了初始化，在路由引擎中配置了各种路由表和路由组，并对各个路由的中间件进行了配置。

**api/upload.go等：**

​	包含了最外层路由调用的一些函数。

**api/v1/tag.go等：**

​	路由组v1中路由调用的一些函数。

### 6. service目录

​	该目录下包含了请求处理函数中调用的一些更细节底层的函数。比如在routers中路由处理函数直接通过GetAll()获取所需要的所有对象，GetAll()函数调用service目录中的相应函数，由该函数**结合传入的参数**以及**models目录下抽象的模型对象访问函数**向上对routers中的函数封装了简洁的服务，屏蔽底层的复杂逻辑。



